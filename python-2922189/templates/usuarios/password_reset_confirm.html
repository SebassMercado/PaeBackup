{% extends 'base.html' %}
{% block title %}Nueva Contraseña{% endblock %}
{% block login_content %}
<div class="login-grid" style="min-height:70vh;">
  <section class="login-card" style="max-width:520px;margin:auto;">
    <h2>Establecer Nueva Contraseña</h2>
    {% if invalid %}
      <div class="alert alert-error">Token inválido o ya usado.</div>
      <a href="/usuarios/password-reset/" class="login-button-main" style="display:inline-block;margin-top:1rem;text-decoration:none;text-align:center;">Solicitar nuevo enlace</a>
    {% elif expired %}
      <div class="alert alert-error">El token expiró. Solicita uno nuevo.</div>
      <a href="/usuarios/password-reset/" class="login-button-main" style="display:inline-block;margin-top:1rem;text-decoration:none;text-align:center;">Solicitar nuevo enlace</a>
    {% else %}
      <p style="color:var(--text-soft);font-size:.85rem;">Ingresa y confirma tu nueva contraseña.</p>
      {% if messages %}<div class="alerts">{% for m in messages %}<div class="alert {% if m.tags == 'error' %}alert-error{% else %}alert-success{% endif %}">{{ m }}</div>{% endfor %}</div>{% endif %}
      <form method="post">
        {% csrf_token %}
        <div class="form-group">
          <label for="password">Nueva contraseña</label>
          <input class="input-control" type="password" id="password" name="password" required minlength="6" placeholder="••••••">
        </div>
        <div class="form-group">
          <label for="password2">Confirmar contraseña</label>
          <input class="input-control" type="password" id="password2" name="password2" required minlength="6" placeholder="••••••">
        </div>
        <button type="submit" class="login-button-main">Guardar</button>
      </form>
      <div style="margin-top:1rem;text-align:center;">
        <a href="/login/" style="font-size:.75rem;color:var(--accent);text-decoration:none;">Ir a Login</a>
      </div>
    {% endif %}
  </section>
</div>
{% endblock %}
